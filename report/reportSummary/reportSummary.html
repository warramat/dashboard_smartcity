<html lang="en">
<head>
    <base href="">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" href="assets/media/logos/favicon.ico" />
    <meta name="csrf-token" content="iGkqHYJmSUIFNgJMVHXBu8EZGi4KQxYfAd9rNYps">
    <title>เทศบาลเมืองปากพูน</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Sarabun:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
        rel="stylesheet">
    <link href="https://pakpooncity.siaminno.co.th/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css">
    <link href="https://pakpooncity.siaminno.co.th/css/style.bundle.css" rel="stylesheet" type="text/css">
    <link href="https://pakpooncity.siaminno.co.th/css/app_style.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="https://pakpooncity.siaminno.co.th/css/sweetalert2.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mitr:wght@200;300;400&display=swap" rel="stylesheet">
    <style>
        .h250 {
            height: 250px;
        }
    </style>
</head>

<body id="kt_body"
    class="header-fixed header-tablet-and-mobile-fixed toolbar-enabled toolbar-fixed toolbar-tablet-and-mobile-fixed"
    style="--kt-toolbar-height:55px;--kt-toolbar-height-tablet-and-mobile:55px">
    <div class="d-flex flex-column flex-root">
        <div class="page d-flex flex-row flex-column-fluid">
            <div class="wrapper d-flex flex-column flex-row-fluid" id="kt_wrapper">
                <div id="kt_header" class="header align-items-stretch">
                    <div class="container d-flex align-items-stretch justify-content-between">
                        <div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0 me-lg-15">
                            <a href="https://pakpooncity.siaminno.co.th/home">
                                <img alt="Logo" src="https://pakpooncity.siaminno.co.th/logo/logo.png" class="h-60px" />
                                <span class="logoname">เทศบาลเมืองปากพูน</span>
                            </a>
                        </div>
                        <div class="d-flex align-items-stretch justify-content-between flex-lg-grow-1">
                            <div class="d-flex align-items-stretch" id="kt_header_nav">
                                <div class="header-menu align-items-stretch" data-kt-drawer="true"
                                    data-kt-drawer-name="header-menu"
                                    data-kt-drawer-activate="{default: true, lg: false}" data-kt-drawer-overlay="true"
                                    data-kt-drawer-width="{default:'200px', '300px': '250px'}"
                                    data-kt-drawer-direction="end" data-kt-drawer-toggle="#kt_header_menu_mobile_toggle"
                                    data-kt-swapper="true" data-kt-swapper-mode="prepend"
                                    data-kt-swapper-parent="{default: '#kt_body', lg: '#kt_header_nav'}">
                                    <div class="menu menu-lg-rounded menu-column menu-lg-row menu-state-bg menu-title-gray-700 menu-state-title-primary menu-state-icon-primary menu-state-bullet-primary menu-arrow-gray-400 fw-bold my-5 my-lg-0 align-items-stretch"
                                        id="#kt_header_menu" data-kt-menu="true">
                                        <div class="menu-item me-lg-1">
                                            <a class="menu-link py-3 " href="../../index.html">
                                                <span class="menu-title">หน้าหลัก</span>
                                            </a>
                                        </div>
                                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start"
                                            class="menu-item menu-lg-down-accordion me-lg-1">
                                            <span class="menu-link py-3 ">
                                                <span class="menu-title">ร้องเรียน</span>
                                                <span class="menu-arrow d-lg-none"></span>
                                            </span>
                                            <div
                                                class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">
                                                <div class="menu-item">
                                                    <a class="menu-link py-3 " href="../../appeal/appeal/appeal.html">
                                                        <span class="menu-bullet">
                                                            <span class="bullet bullet-dot"></span>
                                                        </span>
                                                        <span class="menu-title">ใบงานร้องเรียน</span>
                                                    </a>
                                                </div>
                                                <div class="menu-item">
                                                    <a class="menu-link py-3 " href="../../appeal/apply/apply.html">
                                                        <span class="menu-bullet">
                                                            <span class="bullet bullet-dot"></span>
                                                        </span>
                                                        <span class="menu-title">จัดการหัวข้อเรื่อง</span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start"
                                            class="menu-item menu-lg-down-accordion me-lg-1">
                                            <span class="menu-link py-3 ">
                                                <span class="menu-title">ดูแลสุขภาพ</span>
                                                <span class="menu-arrow d-lg-none"></span>
                                            </span>
                                            <div
                                                class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">
                                                <div class="menu-item">
                                                    <a class="menu-link py-3 "
                                                        href="../../healthcare/healthData/healthData.html">
                                                        <span class="menu-bullet">
                                                            <span class="bullet bullet-dot"></span>
                                                        </span>
                                                        <span class="menu-title">ข้อมูลสุขภาพ</span>
                                                    </a>
                                                </div>
                                                <div class="menu-item">
                                                    <a class="menu-link py-3 "
                                                        href="../../healthcare/healthScreen/healthScreen.html">
                                                        <span class="menu-bullet">
                                                            <span class="bullet bullet-dot"></span>
                                                        </span>
                                                        <span class="menu-title">คัดกรองสุขภาพ</span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="menu-item me-lg-1">
                                            <a class="menu-link py-3 " href="../../petition/petition.html">
                                                <span class="menu-title">ยื่นคำร้อง</span>
                                            </a>
                                        </div>
                                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start"
                                            class="menu-item menu-lg-down-accordion me-lg-1">
                                            <span class="menu-link py-3 ">
                                                <span class="menu-title">ผู้ใช้งาน</span>
                                                <span class="menu-arrow d-lg-none"></span>
                                            </span>
                                            <div
                                                class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">
                                                <div class="menu-item">
                                                    <a class="menu-link py-3 " href="../../user/userList/userList.html">
                                                        <span class="menu-bullet">
                                                            <span class="bullet bullet-dot"></span>
                                                        </span>
                                                        <span class="menu-title">รายชื่อผู้ใช้งาน</span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>

                                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start"
                                            class="menu-item menu-lg-down-accordion me-lg-1">
                                            <span class="menu-link py-3 active">
                                                <span class="menu-title">รายงาน</span>
                                                <span class="menu-arrow d-lg-none"></span>
                                            </span>
                                            <div
                                                class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">
                                                <div class="menu-item">
                                                    <a class="menu-link py-3 active"
                                                        href="../../report/reportSummary/reportSummary.html">
                                                        <span class="menu-bullet">
                                                            <span class="bullet bullet-dot"></span>
                                                        </span>
                                                        <span class="menu-title">รายงานสรุป</span>
                                                    </a>
                                                </div>
                                                <div class="menu-item">
                                                    <a class="menu-link py-3 "
                                                        href="../../report/reportSummary/reportA/reportA.html">
                                                        <span class="menu-bullet">
                                                            <span class="bullet bullet-dot"></span>
                                                        </span>
                                                        <span class="menu-title">ร้องเรียน</span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex align-items-stretch flex-shrink-0">
                                <div class="d-flex align-items-stretch flex-shrink-0">
                                    <div class="d-flex align-items-center ms-1 ms-lg-3" id="kt_header_user_menu_toggle">
                                        <div class="cursor-pointer symbol symbol-30px symbol-md-40px"
                                            data-kt-menu-trigger="click" data-kt-menu-attach="parent"
                                            data-kt-menu-placement="bottom-end" data-kt-menu-flip="bottom">
                                            <img src="https://pakpooncity.siaminno.co.th/media/avatars/blank.png"
                                                alt="metronic" />
                                        </div>
                                        <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg menu-state-primary fw-bold py-4 fs-6 w-275px"
                                            data-kt-menu="true">
                                            <div class="menu-item px-3">
                                                <div class="menu-content d-flex align-items-center px-3">
                                                    <div class="symbol symbol-50px me-5">
                                                        <img alt="Logo"
                                                            src="https://pakpooncity.siaminno.co.th/media/avatars/blank.png" />
                                                    </div>
                                                    <div class="d-flex flex-column">
                                                        <div class="fw-bolder d-flex align-items-center fs-5">
                                                            Warramat Suttikana
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="separator my-2"></div>
                                            <div class="menu-item px-5">
                                                <a href="https://pakpooncity.siaminno.co.th/change_password"
                                                    class="menu-link px-5">เปลี่ยนรหัสผ่าน</a>
                                            </div>
                                            <div class="menu-item px-5">
                                                <a href="https://pakpooncity.siaminno.co.th/logout"
                                                    class="menu-link px-5">ออกจากระบบ</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <p style="font-size: 20px">ตารางแสดงข้อมูลพนักงานในเเทศบาลเมืองปากพูน</p style="font-size: 20px">    
        <div id="table"></div>
        <style>
            #table> div> div.gridjs-wrapper> table> thead> tr> th:nth-child(2)> div {width: 200px;}
            #table> div> div.gridjs-wrapper> table> thead> tr> th:nth-child(3)> div {width: 200px;}
            #table> div> div.gridjs-wrapper> table> thead> tr> th:nth-child(6)> div {width: 200px;}
            #table> div> div.gridjs-wrapper> table> thead> tr> th:nth-child(12)> div {width: 200px;}
            #table> div> div.gridjs-wrapper> table> thead> tr> th:nth-child(15)> div {width: 150px;}
          </style>
          <script src="https://unpkg.com/gridjs/dist/gridjs.umd.js"></script>
          <script type="text/javascript">
                var $btnDLtoExcel = $('DLtoExcel')
                $btnDLtoExcel.on('click', function(){
                    $('table').gridjs({
                        containerid: 'table',
                        datatype: 'table'
                    })
                })
          </script>
          <script>
            new gridjs.Grid({
              columns: [
                "ลำดับ",
                "สังกัด",
                "ตำแหน่ง",
                "กอง",
                "ฝ่าย",
                "ชื่อ - นามสกุล",
                "เพศ",
                "อายุ",
                "น้ำหนัก",
                "ส่วนสูง",
                "BMI",
                "โรคประจำตัว",
                "โรคอื่นๆ",
                "ท่านเคยเจ็บป่วยด้วยโรคจากการทำงาน",
                'ในรอบ 1 ปี ท่านเคยประสบอุบัติเหตุ/การบาดเจ็บจากการทำงานหรือไม่',
                'แผนก-ตำแหน่งงานที่ปฏิบัติ',
                'อายุการทำงาน......ปี.....เดือน',
                'ทำงานวันละกี่ชั่วโมงต่อวัน (ชั่วโมง)',
                'ทำงานวันละกี่วันต่อสัปดาห์ (วัน)',
                'คุณเคยดื่มเครื่องดื่มแอลกอฮอล์ เช่น เบียร์ เหล้า ไวน์ หรือไม่?',
                'ท่านสูบบุหรี่หรือไม่และบ่อยเพียงใด',
                'ท่านออกกำลังกายหรือเล่นกีฬาประเภทใด',
                'ระยะเวลาการออกกำลังกายหรือเล่นกีฬา (นาที/ครั้ง)',
                'ท่านเคยติดเชื้อโควิด-19 (COVID-19) หรือไม่',
                'ท่านได้รับวัคซีนมาแล้วจำนวนกี่ เข็ม',
                'ท่านมีภาระหนี้สินหรือมั้ย',
                'คะแนนรวมประเมินความเครียด(Strain)',
                {
                  name: "คะแนนรวมประเมินความเครียด(Strain)",
                  formatter: (cell) => {
                    if(isNaN(cell)){
                        return  gridjs.html(`<div>-</div>`);
                    }
                    if (Number(cell) < 30) {
                      return gridjs.html(`<div style="color:green">${cell}</div>`);
                    }else if(Number(cell) >= 30 && Number(cell)<= 50) {
                      return gridjs.html(`<div style="color:yellow">${cell}</div>`);
                    } else {
                        return gridjs.html(`<div style="color:red">${cell}</div>`);
                    }
                    }
                },
              ],
              server: {
                url: "https://smartcity-pakpoon-api.herokuapp.com/employee/employeeAll",
                then: (data) =>
                  data.map((employee, i) => {
                    let Strain = 0;
                    for (let j = 1; j <= 20; j++) {
                      Strain += Number(employee[`Strain${j}`]);
                    }
                    return [
                      i + 1,
                      employee.affiliation,
                      employee.position,
                      employee.division,
                      employee.cotton,
                      `${employee.prefix}${employee.name}  ${employee.lastname}`,
                      employee.sex,
                      employee.age,
                      employee.weight,
                      employee.height,
                      employee.BMI,
                      employee.congenital_disease,
                      employee.other_congenital_disease,
                      employee.sick,
                      employee.accident,
                      employee.job_position,
                      employee.working_life,
                      employee.hours_work,
                      employee.day_work,
                      employee.drinking_alcohol1,
                      employee.smoke_often1,
                      employee.exercise1,
                      employee.exercise2,
                      employee.covid1,
                      employee.covid2,
                      employee.debt_information,
                      Strain,
                    ];
                  }),
              },
              search: {
                enabled: true,
              },
              sort: true,
              pagination: {
                enabled: true,
                limit: 20,
                summary: false,
              },
            }).render(document.getElementById("table"));
          </script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js" integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk" crossorigin="anonymous"></script>
    
</body>

</html>
